<nav mat-tab-nav-bar>
  <a mat-tab-link [routerLink]="['/unit/',unitName]" routerLinkActive #rla="routerLinkActive"
    [active]="activeLinkIndex === i" (click)="activeLinkIndex = i">Unidad</a>
  <a mat-tab-link [routerLink]="['/unit/',unitName, 'cards']" routerLinkActive #rla2="routerLinkActive"
    [active]="rla2.isActive">Fichas</a>
</nav>
<div flex="96" layout-wrap>
  <mat-grid-list cols="1" rowHeight="5:1">
    <mat-grid-tile *ngFor="let card of cards">
      <div class="mycard"  flex="100" layout-wrap>
        <mat-card>
          <mat-card-title>
            <div layout="row" layout-align="start center">
              <span flex>{{card.type}}</span>
            </div>
          </mat-card-title>
          <mat-card-content cols="1" layout-align="space-between">
            <div flex="95">
            <mat-form-field *ngIf="loginService.isAdmin" appearance="outline">
              <mat-label></mat-label>
              <textarea matInput cdkTextareaAutosize value="{{card.desc}}"  flex="95"></textarea>
            </mat-form-field>
          </div>
            <p *ngIf="!loginService.isAdmin && loginService.isLogged">{{card.desc}}</p>

            <td-file-upload id="{{card.type}}" color="accent" *ngIf="loginService.isAdmin" #singleFileUpload [(ngModel)]="card.files"
              (select)="selectEvent($event,card)" (upload)="uploadEvent($event, card)" (cancel)="cancelEvent(card)"
              [disabled]="card.disabled">
                <mat-icon>file_upload</mat-icon><span>{{ singleFileUpload.value?.name }}</span>
              <ng-template td-file-input-label>
                <mat-icon>attach_file</mat-icon>
                Subir imagen
              </ng-template>
            </td-file-upload>

            <img *ngIf="card.photo" src="api/unit/{{unitName}}/card/{{card.type}}/image" width="100" height="100">

            <mat-card-actions *ngIf="loginService.isAdmin">
              <button mat-raised-button class="text-upper" color="primary" (click)="saveChanges(card.type)">
                Guardar
              </button>

            </mat-card-actions>
          </mat-card-content>
        </mat-card>
      </div>
    </mat-grid-tile>
  </mat-grid-list>
  <mat-card-actions *ngIf="lastRequestedPage!=undefined && !lastRequestedPage.last">
    <a mat-button color="primary" class="text-upper" (click)="requestNextPage()">
      <span>Ver más</span>
    </a>
  </mat-card-actions>
  <mat-nav-list *ngIf="loginService.isAdmin">
    <mat-list-item>
      <a matListAvatar mat-icon-button matTooltip="add" color="primary" (click) = "changePulsado()"><mat-icon>add</mat-icon></a>
      <span *ngIf = "pulsado">
        <input type="text" [(ngModel)] = "cardName">
        <button (click) = "addCardToList()"> Añadir </button>
      </span>
    </mat-list-item>
 </mat-nav-list>
</div>
